{% extends "base.html" %}
{% block content %}

<nav>
  <div class="navItem" id="active" onclick="goTo('/')">FEED</div>
  <div class="navItem" onclick="goTo('/matches')">MATCHES</div>
  <div class="navItem" onclick="goTo('/account')">ACCOUNT</div>
</nav>

<div class="mainContent">
  <div class="feedDisplay">
    <div class="feedContent">
      <div class="userPresentation" id="userPresentation"></div>
    </div>

    <div class="duckgooseControls">
      <button id="duckBtn" class="duckBtn">Duck</button>
      <button id="gooseBtn" class="gooseBtn">Goose</button>
    </div>
  </div>
</div>

<script>
  function goTo(route) {
    window.location.href = route;
  }

  const profiles = [
    { name: "Sydney", age: 22, question: "Question 1", answer: "Really interesting thought to that question" },
    { name: "Jordan", age: 24, question: "Question 2", answer: "I like long walks on the beach" },
    { name: "Taylor", age: 21, question: "Question 3", answer: "My ideal day is reading and hiking" },
    { name: "Riley", age: 23, question: "Question 4", answer: "I’d travel anywhere with mountains" },
  ];

  let currentIndex = 0;
  const matches = [];

  function renderProfile() {
    const p = profiles[currentIndex];
    const container = document.getElementById("userPresentation");

    if (!p) {
      container.innerHTML = `
        <h2>No more profiles!</h2>
        <p>You’ve reached the end of the feed.</p>
      `;
      document.getElementById("duckBtn").disabled = true;
      document.getElementById("gooseBtn").disabled = true;
      console.log("Matches so far:", matches);
      return;
    }

    container.innerHTML = `
      <h1>${p.name}</h1>
      <h2>${p.age}</h2>
      <h2>${p.question}</h2>
      <p>${p.answer}</p>
    `;
  }

  document.getElementById("duckBtn").addEventListener("click", () => {
    currentIndex++;
    renderProfile();
  });

  document.getElementById("gooseBtn").addEventListener("click", async () => {
    const p = profiles[currentIndex];
    if (p) {
      matches.push(p);
      console.log("You goosed:", p.name);
      try {
        await fetch("/goose", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(p),
        });
      } catch (err) {
        console.error("Error saving match:", err);
      }
    }

    currentIndex++;
    renderProfile();
  });

  renderProfile();
</script>
{% endblock %}
